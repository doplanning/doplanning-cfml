var anchura=700;var tareillas=new Array();var taskNames=new Array();var taskStatus={SUCCEEDED:"bar",FAILED:"bar-failed"};var tasks=new Array();var hecho="";
var comienza=new Date();var finaliza=new Date();var altura=0;function cargarDatos(){if(tareillas.length>0){for(var b=tareillas.length-1;b>=0;b--){taskNames[b]=tareillas[b].title;
if(tareillas[b].done===0){hecho="FAILED";}else{hecho="SUCCEEDED";}taskStatus[b]=hecho;comienza=new Date(tareillas[b].start_date);comienza.setHours(0);finaliza=new Date(tareillas[b].end_date);
finaliza.setHours(0);var a=new Date(tareillas[b].creation_date);tasks[b]={startDate:comienza,endDate:finaliza,creationDate:a,taskName:tareillas[b].title,status:hecho,tareaid:tareillas[b].id};
}altura=tasks.length*37;hacerGantt();}}var gantt;function hacerGantt(){tasks.sort(function(f,e){return f.endDate-e.endDate;});var d=tasks[tasks.length-1].endDate;
tasks.sort(function(f,e){return f.startDate-e.startDate;});var b=tasks[0].startDate;var c="%H:%M";var a="1monthOnlyDays";gantt=d3.gantt().taskTypes(taskNames).taskStatus(taskStatus).tickFormat(c).height(altura).width(anchura);
gantt.timeDomainMode("fit");changeTimeDomain(a);gantt(tasks);}function changeTimeDomain(a){this.timeDomainString=a;switch(a){case"1hr":format="%H:%M:%S";
gantt.timeDomain([d3.time.hour.offset(getEndDate(),-1),getEndDate()]);break;case"3hr":format="%H:%M";gantt.timeDomain([d3.time.hour.offset(getEndDate(),-3),getEndDate()]);
break;case"6hr":format="%H:%M";gantt.timeDomain([d3.time.hour.offset(getEndDate(),-6),getEndDate()]);break;case"1day":format="%H:%M";gantt.timeDomain([d3.time.day.offset(getEndDate(),-1),getEndDate()]);
break;case"1week":format="%a %H:%M";gantt.timeDomain([d3.time.day.offset(getEndDate(),-7),getEndDate()]);break;case"1month":format="%a %H:%M";gantt.timeDomain([d3.time.day.offset(getEndDate(),-7),getEndDate()]);
break;case"1monthOnlyDays":format="%a";gantt.timeDomain([d3.time.month.offset(getEndDate(),-31),getEndDate()]);break;default:format="%H:%M";}gantt.tickFormat(format);
gantt.redraw(tasks);}function getEndDate(){var a=Date.now();if(tasks.length>0){a=tasks[tasks.length-1].endDate;}return a;}function verDatos(a){var b="task.cfm?task="+a.tareaid;
openUrlLite(b,"itemIframe");}var div=d3.select("body").append("div").attr("class","tooltip").style("opacity",0);function showD3Tooltip(a){div.transition().duration(500).style("opacity",0);
div.transition().duration(200).style("opacity",0.9);div.html('<div class="tooltip-inner">'+a.taskName+"</div>").style("left",(d3.event.pageX+3)+"px").style("top",(d3.event.pageY-32)+"px");
}function hideD3Tooltip(a){div.transition().duration(500).style("opacity",0);}function setItems(a){tareillas=a;cargarDatos();}