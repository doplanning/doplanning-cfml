var curAreaId=0;var areaWithLink=false;var currentTab="#tab1";var disableNextTabChange=false;function windowHeight(){var a=document.documentElement;return a.clientHeight;}function getURLParameterFromPath(a,b){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(b)||[,""])[1].replace(/\+/g,"%20"))||null;}function getFilename(a){return a.substring(a.lastIndexOf("/")+1);}function showAlertMessage(b,a){if($("#alertContainer span").length!=0){$("#alertContainer span").remove();}if(a==true){$("#alertContainer").attr("class","alert alert-success");}else{$("#alertContainer").attr("class","alert alert-error");}$("#alertContainer button").after("<span>"+b+"</span>");$("#alertContainer").fadeIn("slow");setTimeout(function(){hideAlertMessage();},9500);}function hideAlertMessage(){$("#alertContainer").fadeOut("slow");}function loadModal(a){$("body").modalmanager("loading");$modal.load(a,"",function(){$modal.modal({width:630});});}function hideModal(a){$(a).modal("hide");}function hideDefaultModal(){$modal.modal("hide");}function postModalForm(c,a,b,d){$("body").modalmanager("loading");$.ajax({type:"POST",url:a,data:$(c).serialize(),success:function(g,e){if(e=="success"){var f=g.message;openUrl(b);hideDefaultModal();$("body").modalmanager("removeLoading");showAlertMessage(f,g.result);}else{alert(e);}},dataType:"json"});}function postModalFormTree(b,a){$("body").modalmanager("loading");$.ajax({type:"POST",url:a,data:$(b).serialize(),success:function(e,c){if(c=="success"){var d=e.message;hideDefaultModal();if(b!="#deleteAreaForm"){disableNextTabChange=true;updateTreeWithSelectedArea(e.area_id);}else{updateTreeWithSelectedArea();}$("body").modalmanager("removeLoading");showAlertMessage(d,e.result);}else{alert(c);}},dataType:"json"});}function openUrl(a,b){if(b=="itemIframe"){if(currentTab=="#tab3"){loadIframeSearchItemPage(a);}else{loadIframeItemPage(a);}}else{if(b=="userAreaIframe"||b=="userAdminIframe"){$("#"+b).attr("src","iframes/"+getFilename(a));}else{if(b=="areaIframe"){if(currentTab!="#tab2"){$('#dpTab a[href="#tab2"]').tab("show");iframePage=a;var c=getURLParameterFromPath("area",a);selectTreeNode(c);}else{loadIframePage(a);}}else{loadIframePage(a);}}}}function loadIframePage(a){$("#areaIframe").attr("src","iframes/"+getFilename(a));}function loadIframeItemPage(a){$("#itemIframe").attr("src","iframes2/"+getFilename(a));}function loadIframeSearchItemPage(a){$("#searchItemIframe").attr("src","iframes2/"+getFilename(a));}function areaIframeLoaded(){}function setWithLink(a){areaWithLink=a;if(a==true){$("#areaImageAnchor").css("cursor","pointer");}else{$("#areaImageAnchor").css("cursor","default");}}function loadTree(){curAreaId=undefined;$("#loadingContainer").show();$("#treeContainer").css("visibility","hidden");var a=Math.floor(Math.random()*1001);$("#treeContainer").load("html_content/tree.cfm?n="+a,function(){showTree(true);});}function updateTree(){loadTree();}function updateTreeWithSelectedArea(a){selectAreaId=a;loadTree();}function selectTreeNode(a){$("#areasTreeContainer").jstree("select_node","#"+a,true);}function areaSelected(c,a,b){curAreaId=c;loadAreaImage(c);setWithLink(b);if(iframePage.length>0){loadIframePage(iframePage);iframePage="";}else{loadIframePage(a);}if(disableNextTabChange){disableNextTabChange=false;}else{if(!$("#changeTabDisabled").is(":checked")){$('#dpTab a[href="#tab2"]').tab("show");}}}function searchTextInTree(){searchInTree(document.getElementById("searchText").value);}