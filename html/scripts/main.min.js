var curAreaId="undefined";var areaWithLink=false;var currentTab="#tab1";var disableNextTabChange=false;function getURLParameterFromPath(a,b){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(b)||[,""])[1].replace(/\+/g,"%20"))||null;
}function getFilename(a){return a.substring(a.lastIndexOf("/")+1);}function showAlertModal(b){var a={msg:b,error:false};$("#alertModal").html(tmpl("tmpl-alert-modal",a));
$("#alertModal").modal({width:650,backdrop:"static"});}function showConfirmModal(c,a){var b={msg:c,error:false,confirm:true,callBackFunction:a};$("#alertModal").html(tmpl("tmpl-alert-modal",b));
$("#alertModal").modal({width:650,backdrop:"static"});return false;}function showAlertErrorModal(b){var a={msg:b,error:true};$("#alertModal").html(tmpl("tmpl-alert-modal",a));
$("#alertModal").modal({width:650,backdrop:"static"});}function loadModal(a){$("body").modalmanager("loading");var b=generateRandom();if(a.indexOf("?")==-1){a=a+"?n"+b;
}else{a=a+"&n"+b;}$modal.load(a,"",function(){$modal.modal({width:740,backdrop:"static"});});}function hideModal(a){$(a).modal("hide");}function hideDefaultModal(){$modal.modal("hide");
}function postModalForm(c,a,b,d){$("body").modalmanager("loading");$.ajax({type:"POST",url:a,data:$(c).serialize(),dataType:"json",success:function(g,e){if(e=="success"){var f=g.message;
hideDefaultModal();openUrl(b,d);$("body").modalmanager("removeLoading");showAlertMessage(f,g.result);}else{alert(e);}}});}function postModalFormTree(b,a){$("body").modalmanager("loading");
$.ajax({type:"POST",url:a,data:$(b).serialize(),dataType:"json",success:function(e,c){if(c=="success"){var d=e.message;hideDefaultModal();if(b!="#deleteAreaForm"){disableNextTabChange=true;
updateTreeWithSelectedArea(e.area_id);}else{updateTree();}$("body").modalmanager("removeLoading");showAlertMessage(d,e.result);}else{alert(c);}}});}function openUrl(b,c){if(c=="itemIframe"){if(currentTab=="#tab3"){loadIframeSearchItemPage(b);
}else{loadIframeItemPage(b);}}else{if(c=="userAreaIframe"||c=="userAdminIframe"||c=="allUsersIframe"||c=="logItemIframe"){$("#"+c).attr("src","iframes/"+getFilename(b));
}else{if(c=="areaIframe"){if(currentTab!="#tab2"){$('#dpTab a[href="#tab2"]').tab("show");}var a=getURLParameterFromPath("area",b);if($.isNumeric(a)&&a!=curAreaId){iframePage=b;
selectTreeNode(a);}else{loadIframePage(b);}}else{loadIframePage(b);}}}}function loadIframePage(a){a=addClientAbbToPage(a);$("#areaIframe").attr("src","iframes/"+getFilename(a));
}function loadIframeItemPage(a){a=addClientAbbToPage(a);$("#itemIframe").attr("src","iframes2/"+getFilename(a));}function loadIframeSearchItemPage(a){a=addClientAbbToPage(a);
$("#searchItemIframe").attr("src","iframes2/"+getFilename(a));}function addClientAbbToPage(c){var a="";var b=c.indexOf("#");if(b!=-1){a=c.substring(b,c.length);
c=c.substring(0,b);}if(c.indexOf("?")==-1){c=c+"?abb="+clientAbb;}else{c=c+"&abb="+clientAbb;}if(b!=-1){c=c+a;}return c;}function areaIframeLoaded(){}function setWithLink(a){areaWithLink=a;
if(a==true){$("#areaImageAnchor").css("cursor","pointer");}else{$("#areaImageAnchor").css("cursor","default");}}function loadTree(){curAreaId="undefined";
$("#loadingContainer").show();$("#treeContainer").css("visibility","hidden");var a=generateRandom();$("#treeContainer").load("html_content/tree.cfm?n="+a,function(){showTree(true);
});}function updateTree(){loadTree();}function updateTreeWithSelectedArea(a){selectAreaId=a;loadTree();}function selectTreeNode(a){$("#areasTreeContainer").jstree("deselect_all");
if($("#areasTreeContainer").jstree("select_node",a)==false){alert("Área no accesible en su árbol");iframePage="";}}function areaSelected(c,a,b){curAreaId=c;
loadAreaImage(c);setWithLink(b);if(iframePage.length>0){loadIframePage(iframePage);iframePage="";}else{loadIframePage(a);}if(disableNextTabChange){disableNextTabChange=false;
}else{if(!$("#changeTabDisabled").is(":checked")){$('#dpTab a[href="#tab2"]').tab("show");}}}function searchTextInTree(){searchInTree(document.getElementById("searchText").value);
}function showTreeTab(){$('#dpTab a[href="#tab1"]').tab("show");}