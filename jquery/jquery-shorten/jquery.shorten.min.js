(function(a){a.fn.shorten=function(c){var b={showChars:100,ellipsesText:"...",moreText:"more",lessText:"less",errMsg:null,force:false};if(c){a.extend(b,c);
}if(a(this).data("jquery.shorten")&&!b.force){return false;}a(this).data("jquery.shorten",true);a(document).off("click",".morelink");a(document).on({click:function(){var d=a(this);
if(d.hasClass("less")){d.removeClass("less");d.html(b.moreText);d.parent().prev().prev().show();d.parent().prev().hide();}else{d.addClass("less");d.html(b.lessText);
d.parent().prev().prev().hide();d.parent().prev().show();}return false;}},".morelink");return this.each(function(){var q=a(this);var n=q.html();var o=q.text().length;
if(o>b.showChars){var p=n.substr(0,b.showChars);if(p.indexOf("<")>=0){var g=false;var e="";var k=0;var m=[];var f=null;for(var h=0,d=0;d<=b.showChars;h++){if(n[h]=="<"&&!g){g=true;
f=n.substring(h+1,n.indexOf(">",h));if(f[0]=="/"){if(f!="/"+m[0]){b.errMsg="ERROR en HTML: the top of the stack should be the tag that closes";}else{m.shift();
}}else{if(f.toLowerCase()!="br"){m.unshift(f);}}}if(g&&n[h]==">"){g=false;}if(g){e+=n.charAt(h);}else{d++;if(k<=b.showChars){e+=n.charAt(h);k++;}else{if(m.length>0){for(j=0;
j<m.length;j++){e+="</"+m[j]+">";}break;}}}}}p=a("<div/>").html(p+'<span class="ellip">'+b.ellipsesText+"</span>").html();var l='<span class="shortcontent">'+p+'</span><span class="allcontent">'+n+'</span><span><a href="javascript://nop/" class="morelink">'+b.moreText+"</a></span>";
q.html(l);q.find(".allcontent").hide();a(".shortcontent p:last",q).css("margin-bottom",0);}});};})(jQuery);