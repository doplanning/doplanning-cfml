/*! Widget: math - updated 11/22/2015 (v2.24.6) */
(function(c){var b=c.tablesorter,a={error:{0:"Infinity result: Divide by zero",1:"Need more than one element to make this calculation",undef:"No elements found"},invalid:function(f,d,e){console.log(d,a.error[e]);return f&&f.widgetOptions.math_none||"none"},events:("tablesorter-initialized update updateAll updateRows addRows updateCell filterReset filterEnd ").split(" ").join(".tsmath "),processText:function(f,e){var d=e.attr(f.textAttribute);if(typeof d==="undefined"){d=e[0].textContent||e.text()}d=b.formatFloat(d.replace(/[^\w,. \-()]/g,""),f.table)||0;return isNaN(d)?0:d},getRow:function(k,h){var f,i=k.widgetOptions,j=[],e=h.closest("tr"),g=e.hasClass(i.filter_filteredRow||"filtered"),d=e.attr(i.math_dataAttrib+"-filter")||i.math_rowFilter;if(d){e=e.filter(d)}if(!g||d){f=e.children().not("["+i.math_dataAttrib+"=ignore]");if(i.math_ignore.length){f=f.filter(function(l){return c.inArray(a.getCellIndex(c(this)),i.math_ignore)===-1})}j=f.not(h).map(function(){return a.processText(k,c(this))}).get()}return j},getColumn:function(o,t,p){var j,f,h,k,g,d,r=o.widgetOptions,i=[],m=t.closest("tr"),n=r.math_dataAttrib,e=m.attr(n+"-filter")||r.math_rowFilter,l=r.filter_filteredRow||"filtered",q=a.getCellIndex(t),s=o.$table.children("tbody").children();if(p==="above"){k=s.index(m);j=k;while(j>=0){h=s.eq(j);if(e){h=h.filter(e)}f=h.children().filter(function(u){return a.getCellIndex(c(this))===q});d=f.filter("["+n+"^=above]").length;if(((!h.hasClass(l)||e)&&h.not("["+n+"=ignore]").length&&j!==k)||d&&j!==k){if(d){j=0}else{if(f.length){i.push(a.processText(o,f))}}}j--}}else{if(p==="below"){k=s.length;for(j=s.index(m)+1;j<k;j++){h=s.eq(j);if(e){h=h.filter(e)}f=h.children().filter(function(u){return a.getCellIndex(c(this))===q});if(f.filter("["+n+"^=below]").length){break}if((!h.hasClass(l)||e)&&h.not("["+n+"=ignore]").length&&f.length){i.push(a.processText(o,f))}}}else{g=s.not("["+n+"=ignore]");k=g.length;for(j=0;j<k;j++){h=g.eq(j);if(e){h=h.filter(e)}f=h.children().filter(function(u){return a.getCellIndex(c(this))===q});if((!h.hasClass(l)||e)&&f.not("["+n+"^=above],["+n+"^=below],["+n+"^=col]").length&&!f.is(t)){i.push(a.processText(o,f))}}}}return i},getAll:function(k){var f,e,i,m,q,r,l,o,g=[],n=k.widgetOptions,j=n.math_dataAttrib,h=n.filter_filteredRow||"filtered",d=n.filter_rowFilter,p=k.$table.children("tbody").children().not("["+j+"=ignore]");q=p.length;for(m=0;m<q;m++){i=p.eq(m);if(d){i=i.filter(d)}if(!i.hasClass(h)||d){r=i.children().not("["+j+"=ignore]");o=r.length;for(l=0;l<o;l++){f=r.eq(l);e=a.getCellIndex(f);if(!f.filter("["+j+"]").length&&c.inArray(e,n.math_ignore)<0){g.push(a.processText(k,f))}}}}return g},setColumnIndexes:function(g){g.$table.after('<div id="_tablesorter_table_placeholder"></div>');var e=g.$table.detach(),f=1,d=e.children("tbody").children().filter(function(){var j,k,i,l=c(this),h=l.children("[colspan]").length>0;if(f>1){f--;h=true}else{if(f<1){f=1}}if(l.children("[rowspan]").length>0){j=this.cells;for(k=0;k<j.length;k++){f=Math.max(j[k].rowSpan,f)}}return h});b.computeColumnIndex(d,g);c("#_tablesorter_table_placeholder").after(e).remove()},getCellIndex:function(e){var d=e.attr("data-column");return typeof d==="undefined"?e[0].cellIndex:parseInt(d,10)},recalculate:function(j,g,i){if(j&&(!g.math_isUpdating||i)){var f,h,e,d;if(j.debug){h=new Date()}if(i){a.setColumnIndexes(j)}g.math_dataAttrib="data-"+(g.math_data||"math");e=g.math_dataAttrib;d=j.$tbodies.children("tr").children("["+e+"]");a.mathType(j,d,g.math_priority);d=j.$table.children("."+j.cssInfoBlock+", tfoot").children("tr").children("["+e+"]");a.mathType(j,d,g.math_priority);d=j.$table.children().children("tr").children("["+e+"^=all]");a.mathType(j,d,["all"]);g.math_isUpdating=true;if(j.debug){console[console.group?"group":"log"]("Math widget triggering an update after recalculation")}b.update(j,f,function(){a.updateComplete(j)});if(j.debug){console.log("Math widget update completed"+b.benchmark(h))}}},updateComplete:function(e){var d=e.widgetOptions;if(d.math_isUpdating&&e.debug&&console.groupEnd){console.groupEnd()}d.math_isUpdating=false},mathType:function(l,o,n){if(o.length){var k,q,p,i,f,e,h,g,m=l.widgetOptions,j=m.math_dataAttrib,d=b.equations;if(n[0]==="all"){f=a.getAll(l)}if(l.debug){console[console.group?"group":"log"]("Tablesorter Math widget recalculation")}c.each(n,function(r,s){e=o.filter("["+j+"^="+s+"]");g=e.length;if(g){if(l.debug){console[console.group?"group":"log"](s)}for(h=0;h<g;h++){p=e.eq(h);if(p.parent().hasClass(m.filter_filteredRow||"filtered")){continue}k=(p.attr(j)||"").replace(s+"-","");i=(s==="row")?a.getRow(l,p):(s==="all")?f:a.getColumn(l,p,s);if(d[k]){if(i.length){q=d[k](i,l);if(l.debug){console.log(p.attr(j),i,"=",q)}}else{q=a.invalid(l,k,k==="mean"?0:"undef")}a.output(p,m,q,i)}}if(l.debug&&console.groupEnd){console.groupEnd()}}});if(l.debug&&console.groupEnd){console.groupEnd()}}},output:function(h,f,g,i){var e=h.attr("data-"+f.math_data+"-mask")||f.math_mask,d=b.formatMask(e,g,f.math_wrapPrefix,f.math_wrapSuffix);if(typeof f.math_complete==="function"){d=f.math_complete(h,f,d,g,i)}if(d!==false){h.html(d)}}};b.formatMask=function(u,A,q,e){if(!u||isNaN(+A)){return A}var p,o,h,n,y,m,x,s,f,w,r,k,l,i,d,g="",v=u.length,j=u.search(/[0-9\-\+#]/),z=j>0?u.substring(0,j):"",t=z;if(j>0&&q){if(/\{content\}/.test(q||"")){t=(q||"").replace(/\{content\}/g,z||"")}else{t=(q||"")+z}}d=u.split("").reverse().join("");i=d.search(/[0-9\-\+#]/);l=v-i;l+=(u.substring(l,l+1)===".")?1:0;z=i>0?u.substring(l,v):"";g=z;if(z!==""&&e){if(/\{content\}/.test(e||"")){g=(e||"").replace(/\{content\}/g,z||"")}else{g=z+(e||"")}}u=u.substring(j,l);A=u.charAt(0)=="-"?-A:+A;p=A<0?A=-A:0;o=u.match(/[^\d\-\+#]/g);h=(o&&o[o.length-1])||".";n=(o&&o[1]&&o[0])||",";u=u.split(h);A=A.toFixed(u[1]&&u[1].length);A=+(A)+"";m=u[1]&&u[1].lastIndexOf("0");s=A.split(".");if(!s[1]||(s[1]&&s[1].length<=m)){A=(+A).toFixed(m+1)}f=u[0].split(n);u[0]=f.join("");y=u[0]&&u[0].indexOf("0");if(y>-1){while(s[0].length<(u[0].length-y)){s[0]="0"+s[0]}}else{if(+s[0]===0){s[0]=""}}A=A.split(".");A[0]=s[0];x=(f[1]&&f[f.length-1].length);if(x){w=A[0];r="";k=w.length%x;v=w.length;for(l=0;l<v;l++){r+=w.charAt(l);if(!((l-k+1)%x)&&l<v-x){r+=n}}A[0]=r}A[1]=(u[1]&&A[1])?h+A[1]:"";return t+((p?"-":"")+A[0]+A[1])+g};b.equations={count:function(d){return d.length},sum:function(g){var e,d=g.length,f=0;for(e=0;e<d;e++){f+=g[e]}return f},mean:function(e){var d=b.equations.sum(e);return d/e.length},median:function(f,g){var e,d=f.length;if(d>1){f.sort(function(i,h){return i-h});e=Math.floor(d/2);return(d%2)?f[e]:(f[e-1]+f[e])/2}return a.invalid(g,"median",1)},mode:function(j){var e,g,d,f={},i=1,h=[j[0]];for(e=0;e<j.length;e++){g=j[e];f[g]=f[g]?f[g]+1:1;d=f[g];if(d>i){h=[g];i=d}else{if(d===i){h.push(g);i=d}}}return h.sort(function(l,k){return l-k})},max:function(d){return Math.max.apply(Math,d)},min:function(d){return Math.min.apply(Math,d)},range:function(e){var d=e.sort(function(g,f){return g-f});return d[e.length-1]-d[0]},variance:function(h,e,k){var j,g=b.equations.mean(h),d=0,f=h.length;while(f--){d+=Math.pow((h[f]-g),2)}j=(h.length-(e?0:1));if(j===0){return a.invalid(k,"variance",0)}d/=j;return d},varp:function(d,e){return b.equations.variance(d,true,e)},vars:function(d,e){return b.equations.variance(d,false,e)},stdevs:function(e,f){var d=b.equations.variance(e,false,f);return Math.sqrt(d)},stdevp:function(e,f){var d=b.equations.variance(e,true,f);return Math.sqrt(d)}};b.addWidget({id:"math",priority:100,options:{math_data:"math",math_ignore:[],math_mask:"#,##0.00",math_complete:null,math_priority:["row","above","below","col"],math_prefix:"",math_suffix:"",math_none:"N/A",math_event:"recalculate",math_rowFilter:""},init:function(f,e,h,d){var g=b.hasWidget(f,"filter")?"filterEnd":"updateComplete";h.$table.off((a.events+" updateComplete.tsmath "+d.math_event).replace(/\s+/g," ")).on(a.events+" "+d.math_event,function(i){var j=i.type==="tablesorter-initialized";if(!d.math_isUpdating||j){if(!/filter/.test(i.type)&&!j){a.setColumnIndexes(h)}a.recalculate(h,d,j)}}).on(g+".tsmath",function(){setTimeout(function(){a.updateComplete(h)},40)});d.math_isUpdating=false;if(f.hasInitialized){a.recalculate(h,d,true)}},remove:function(e,g,d,f){if(f){return}g.$table.off((a.events+" updateComplete.tsmath "+d.math_event).replace(/\s+/g," ")).children().children("tr").children("[data-"+d.math_data+"]").empty()}})})(jQuery);