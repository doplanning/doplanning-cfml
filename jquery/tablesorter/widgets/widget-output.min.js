/*! Widget: output - updated 1/15/2016 (v2.25.2) */
(function(c){var b=c.tablesorter,a=b.output={event:"outputTable",regexQuote:/([\n\t\x09\x0d\x0a]|<[^<]+>)/,regexBR:/(<br([\s\/])?>|\n)/g,regexIMG:/<img[^>]+alt\s*=\s*['"]([^'"]+)['"][^>]*>/i,regexHTML:/<[^<]+>/g,replaceCR:"\x0d\x0a",replaceTab:"\x09",popupTitle:"Output",popupStyle:"width:100%;height:100%;",message:"Your device does not support downloading. Please try again in desktop browser.",init:function(d){d.$table.off(a.event).on(a.event,function(f){f.stopPropagation();a.process(d,d.widgetOptions)})},processRow:function(u,r,g,w){var i,s,n,l,j,h,v,d,m,p,f=u.widgetOptions,t=[],q=f.output_duplicateSpans,o=g&&w&&f.output_headerRows&&c.isFunction(f.output_callbackJSON),k=0,e=r.length;for(l=0;l<e;l++){if(!t[l]){t[l]=[]}k=0;s=r.eq(l).children();n=s.length;for(v=0;v<n;v++){i=s.eq(v);if(i.filter("[rowspan]").length){d=parseInt(i.attr("rowspan"),10)-1;p=a.formatData(u,f,i,g);for(j=1;j<=d;j++){if(!t[l+j]){t[l+j]=[]}t[l+j][k]=g?p:q?p:""}}if(i.filter("[colspan]").length){m=parseInt(i.attr("colspan"),10)-1;p=a.formatData(u,f,i,g);for(h=1;h<=m;h++){if(i.filter("[rowspan]").length){d=parseInt(i.attr("rowspan"),10);for(j=0;j<d;j++){if(!t[l+j]){t[l+j]=[]}t[l+j][k+h]=o?f.output_callbackJSON(i,p,k+h)||p+"("+(k+h)+")":g?p:q?p:""}}else{t[l][k+h]=o?f.output_callbackJSON(i,p,k+h)||p+"("+(k+h)+")":g?p:q?p:""}}}while(typeof t[l][k]!=="undefined"){k++}t[l][k]=t[l][k]||a.formatData(u,f,i,g);k++}}return b.output.removeColumns(u,f,t)},removeColumns:function(k,f,h){var j,i,e,g=[],d=h.length;for(j=0;j<d;j++){i=h[j];g[j]=[];for(e=0;e<k.columns;e++){if(!f.output_hiddenColumnArray[e]){g[j].push(i[e])}}}return g},process:function(o,f){var u,j,l,d,i,n,k,p,q=window.JSON&&JSON.hasOwnProperty("stringify"),r=0,h=(f.output_separator||",").toLowerCase(),t=h==="json",m=h==="array",g=t||m?",":f.output_separator,e=f.output_saveRows,s=o.$table;f.output_regex=new RegExp("("+(/\\/.test(g)?"\\":"")+g+")");f.output_hiddenColumnArray=[];for(r=0;r<o.columns;r++){f.output_hiddenColumnArray[r]=c.inArray(r,f.output_ignoreColumns)>-1||(!f.output_hiddenColumns&&o.$headerIndexed[r].css("display")==="none"&&!o.$headerIndexed[r].hasClass("tablesorter-scroller-hidden-column"))}j=s.children("thead").children("tr").not("."+(b.css.filterRow||"tablesorter-filter-row")).filter(function(){return f.output_hiddenColumns||c(this).css("display")!=="none"});d=a.processRow(o,j,true,t);l=s.children("tbody").children("tr");l=typeof e==="function"?l.filter(e):/^f/.test(e)?l.not("."+(f.filter_filteredRow||"filtered")):/^v/.test(e)?l.filter(":visible"):/^[.#:\[]/.test(e)?l.filter(e):l;i=a.processRow(o,l);if(f.output_includeFooter){i=i.concat(a.processRow(o,s.children("tfoot").children("tr:visible")))}n=d.length;if(t){h=[];k=i.length;for(r=0;r<k;r++){p=d[(n>1&&f.output_headerRows)?r%n:n-1];h.push(a.row2Hash(p,i[r]))}u=q?JSON.stringify(h):h}else{p=[d[(n>1&&f.output_headerRows)?r%n:n-1]];h=a.row2CSV(f,f.output_headerRows?d:p,m).concat(a.row2CSV(f,i,m));u=m&&q?JSON.stringify(h):h.join("\n")}if(c.isFunction(f.output_callback)){p=f.output_callback(o,u);if(p===false){return}else{if(typeof p==="string"){u=p}}}if(/p/i.test(f.output_delivery||"")){a.popup(u,f.output_popupStyle,t||m)}else{a.download(f,u)}},row2CSV:function(g,d,f){var e,j,i=[],h=d.length;for(j=0;j<h;j++){e=(d[j]||[]).join("").replace(/\"/g,"");if((d[j]||[]).length>0&&e!==""){i[i.length]=f?d[j]:d[j].join(g.output_separator)}}return i},row2Hash:function(h,e){var g,f={},d=e.length;for(g=0;g<d;g++){if(g<h.length){f[h[g]]=e[g]}}return f},formatData:function(i,j,l,d){var h=l.attr(j.output_dataAttrib),e=typeof h!=="undefined"?h:l.html(),g=(j.output_separator||",").toLowerCase(),f=g==="json"||g==="array",k=e.replace(/\"/g,j.output_replaceQuote||"\u201c");if(!j.output_trimSpaces){k=k.replace(a.regexBR,a.replaceCR).replace(/\t/g,a.replaceTab)}else{k=k.replace(a.regexBR,"")}e=k.match(a.regexIMG);if(!j.output_includeHTML&&e!==null){k=e[1]}k=j.output_includeHTML&&!d?k:k.replace(a.regexHTML,"");k=j.output_trimSpaces||d?c.trim(k):k;g=f?false:j.output_wrapQuotes||j.output_regex.test(k)||a.regexQuote.test(k);k=g?'"'+k+'"':k;if(typeof j.output_formatContent==="function"){return j.output_formatContent(i,j,{isHeader:d,$cell:l,content:k})}return k},popup:function(f,e,d){var g=window.open("",a.popupTitle,e);g.document.write("<html><head><title>"+a.popupTitle+'</title></head><body><textarea wrap="'+(d?"on":"off")+'" style="'+a.popupStyle+'">'+f+"\n</textarea></body></html>");g.document.close();g.focus();return true},download:function(f,i){var j,d,l,k=window.navigator,h=document.createElement("a");if(/(iP)/g.test(k.userAgent)){alert(a.message);return false}try{l=!!new Blob()}catch(g){l=false}if(l){window.URL=window.URL||window.webkitURL;d=new Blob(["\ufeff",i],{type:f.output_encoding});if(k.msSaveBlob){k.msSaveBlob(d,f.output_saveFileName)}else{h.href=window.URL.createObjectURL(d);h.download=f.output_saveFileName;if(document.createEvent){j=document.createEvent("MouseEvents");j.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);h.dispatchEvent(j)}}return false}window.open(f.output_encoding+encodeURIComponent(i)+"?download","_self");return true},remove:function(d){d.$table.off(a.event)}};b.addWidget({id:"output",options:{output_separator:",",output_ignoreColumns:[],output_hiddenColumns:false,output_includeFooter:false,output_dataAttrib:"data-name",output_headerRows:false,output_delivery:"popup",output_saveRows:"filtered",output_duplicateSpans:true,output_replaceQuote:"\u201c;",output_includeHTML:false,output_trimSpaces:true,output_wrapQuotes:false,output_popupStyle:"width=500,height=300",output_saveFileName:"mytable.csv",output_formatContent:null,output_callback:function(d,e){return true},output_callbackJSON:function(f,d,e){return d+"("+(e)+")"},output_encoding:"data:application/octet-stream;charset=utf8,"},init:function(e,d,f){a.init(f)},remove:function(d,e){a.remove(e)}})})(jQuery);